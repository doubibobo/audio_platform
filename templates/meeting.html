<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>B508</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<link rel="stylesheet" href="{{ url_for('static', filename='stylesheets/templatemo-style.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='stylesheets/dropzone.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='stylesheets/font-awesome.min.css') }}">
		<link rel="stylesheet" href="{{ url_for('static', filename='stylesheets/styles.css') }}">

		<script src="{{ url_for('static', filename='javascripts/dropzone.min.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/wavesurfer.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/wavesurfer.spectrogram.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/wavesurfer.regions.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/wavesurfer.cursor.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/wavesurfer.timeline.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/jquery.min.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/RecordRTC.min.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/recorder.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/bootstrap.min.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/serversource.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/app.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/index.js')}}"></script>
		<script src="{{ url_for('static', filename='javascripts/trivia.js')}}"></script>
        <script type="text/javascript" charset="utf-8">
            $(document).ready(function() {
                // Use a "/test" namespace.
                // An application can open a connection on multiple namespaces, and
                // Socket.IO will multiplex all those connections on a single
                // physical channel. If you don't care about multiple channels, you
                // can set the namespace to an empty string.
                namespace = '/test';

                // Connect to the Socket.IO server.
                // The connection URL has the following format, relative to the current page:
                //     http[s]://<domain>:<port>[/<namespace>]
                let socket = io(namespace);

                // Event handler for new connections.
                // The callback function is invoked when a connection with the
                // server is established.
                socket.on('connect', function() {
                    socket.emit('my_event', {data: 'I\'m connected!'});
                });

                // Event handler for server sent data.
                // The callback function is invoked whenever the server emits data
                // to the client. The data is then displayed in the "Received"
                // section of the page.
                socket.on('my_response', function(msg, cb) {
                    $('#log').append('<br>' + $('<div/>').text('Received #' + msg.count + ': ' + msg.data).html());

                    if (cb)
                        cb();
                });

                // Interval function that tests message latency by sending a "ping"
                // message. The server then responds with a "pong" message and the
                // round trip time is measured.
                var ping_pong_times = [];
                var start_time;
                window.setInterval(function() {
                    start_time = (new Date).getTime();
                    socket.emit('my_ping');
                }, 10000);

                // Handler for the "pong" message. When the pong is received, the
                // time from the ping is stored, and the average of the last 30
                // samples is average and displayed.
                socket.on('my_pong', function() {
                    var latency = (new Date).getTime() - start_time;
                    ping_pong_times.push(latency);
                    ping_pong_times = ping_pong_times.slice(-30); // keep last 30 samples
                    var sum = 0;
                    for (var i = 0; i < ping_pong_times.length; i++)
                        sum += ping_pong_times[i];
                    $('#ping-pong').text(Math.round(10 * sum / ping_pong_times.length) / 10);
                });

                // Handlers for the different forms in the page.
                // These accept data from the user and send it to the server in a
                // variety of ways
                $('form#emit').submit(function(event) {
                    socket.emit('my_event', {data: $('#emit_data').val()});
                    return false;
                });
                $('form#broadcast').submit(function(event) {
                    socket.emit('my_broadcast_event', {data: $('#broadcast_data').val()});
                    return false;
                });
                $('form#join').submit(function(event) {
                    socket.emit('join', {room: $('#join_room').val()});
                    return false;
                });
                $('form#leave').submit(function(event) {
                    socket.emit('leave', {room: $('#leave_room').val()});
                    return false;
                });
                $('form#send_room').submit(function(event) {
                    socket.emit('my_room_event', {room: $('#room_name').val(), data: $('#room_data').val()});
                    return false;
                });
                $('form#close').submit(function(event) {
                    socket.emit('close_room', {room: $('#close_room').val()});
                    return false;
                });
                $('form#disconnect').submit(function(event) {
                    socket.emit('disconnect_request');
                    return false;
                });
        });
    </script>
	</head>

	<body>

		<div class="container">
			<!-- Top box -->
			<!-- Logo & Site Name -->
			<div class="placeholder">
				<div class="col-md-6 col-12">
					<img src="../static/img/logo.png" alt="Logo" class="tm-site-logo" />
					<div class="tm-site-text-box">
						<!--
							<h1 class="tm-site-title">武汉光电国家研究中心</h1>
						-->
						<h1 class="tm-site-description">大数据与智能认知实验室</h1>
					</div>
				</div>

			</div>

			<main>
				<header class="row tm-welcome-section">
                    <label for="server-select">服务器选择</label>
                    <select id="server-select">
						<option value="edge" selected="selected">边缘服务器</option>
						<option value="cloud">云服务器</option>
					</select>
					<h2 class="col-12 text-center tm-section-title">Online Meeting System</h2>
					<p class="col-12 text-left">Speaker recognition system knows “who you are” as soon as it hears your speech voice. Of course, if your voice has not been enrolled, you will be considered as a stranger. In the future, we will develop systems that only understand specific person’s speech utterances via combining automatic speech recognition and speaker recognition.</p>
				</header>

				<div class="row tm-gallery">
					<!-- Distinguish Page -->
					<div id="voiceprintdetection-distinguish-page" class="tm-gallery-page vd-gallery-page">
						<div class="tm-paging-links" style="position: relative;margin:auto;">
							<ul style="font-size: x-small">
								<!-- <li class="tm-paging-item" style="max-width: 150px">
									<select id="mp3_name4" class="form-control">
										<option selected="selected">-Please select audio-</option>
										{% for mp3 in all_mp3_files1 %}
										<option value="{{mp3}}">{{mp3}}</option>
										{% endfor %}
									</select>
								</li> -->
								<!--
								<li class="tm-paging-item" data-action="play"><a class="tm-paging-button">Play/Pause</a>
								</li>
								<li class="tm-paging-item" data-action="stop"><a class="tm-paging-button">Stop</a>
								-->
                                <li class="tm-paging-item" data-action="meeting_reco_starting"><a class="tm-paging-button">StartRecording</a>
								</li>
								<li class="tm-paging-item" data-action="meeting_reco_ending"><a class="tm-paging-button">StopRecording</a>
								</li>
							</ul>
						</div>
						<br><br><br>
						<div id="demo" class="tm-gallery-item" style="margin: auto;">
							<div id="dialogs-result" class="tm-gallery-item presult" style="border: 1px solid #000;margin: auto;">
								<ul style="font-size: xx-large;margin: 20px 80px;">
										<div class="form-group">
                                            <label for="meeting-asr-sr">识别结果</label>
                                            <textarea class="form-control" id="meeting-asr-sr" rows="15"></textarea>
										</div>
								</ul>
							</div>
							<div id="waveform6" class="tm-gallery-item" style="border: 1px solid #000;">
								<br />
								<div class="progress progress-striped active" id="progress-bar">
									<div class="progress-bar progress-bar-info"></div>
								</div>
							</div>
							<div id="wave-timeline6" class="wave-timeline" style="background-color: azure"></div>
							<p style="text-align: center;font-size: x-large; font-style: italic">waveform</p>
							<!-- Here be waveform -->
							<div id="wave-spectrogram6" class="tm-gallery-item" style="border: 1px solid #000;"></div>
							<p style="text-align: center;font-size: x-large; font-style: italic">spectrogram</p>
						</div>
						<br><br><br>

					</div>
                </div>
			</main>

			<footer class="tm-footer text-center">
				<button id="return-index-btn"><a href="/">>>Back to main page</a></button>
				<p>Copyright &copy; 2019-2020.WLNO-B508 All rights reserved.</p>
			</footer>
		</div>

	</body>
</html>